doctype html
html
  head
    link(rel="icon", type="image/x-icon", href="/favicon.ico")
    title= title || 'Sakila Video Store'
    link(rel="stylesheet", href="/bootstrap/css/bootstrap.min.css")
    link(rel="stylesheet", href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css")
    script(src="/bootstrap/js/bootstrap.bundle.min.js")
    link(rel='stylesheet', href='/stylesheets/style.css')
    script(src='/javascripts/delete.user.js')
  body
    nav.navbar.navbar-expand-lg.bg-dark.border-bottom.border-body(data-bs-theme='dark')
      .container-fluid
        a.navbar-brand(href='/') 
          i.fas.fa-video.me-2
          | Sakila Video Store
        button.navbar-toggler(type='button' data-bs-toggle='collapse' data-bs-target='#navbarSupportedContent' aria-controls='navbarSupportedContent' aria-expanded='false' aria-label='Toggle navigation')
          span.navbar-toggler-icon
        
        .collapse.navbar-collapse#navbarSupportedContent
          ul.navbar-nav.me-auto.mb-2.mb-lg-0
            li.nav-item
              a.nav-link(href='/' class=req && req.path === '/' ? 'active' : '') 
                i.fas.fa-home.me-1
                | Home
            
            //- Show different navigation based on user role
            if authenticated && user
              if user.role === 'staff' || user.role === 'manager'
                li.nav-item
                  a.nav-link(href='/reports/staff-performance' class=req && req.path.includes('/reports') ? 'active' : '')
                    i.fas.fa-chart-bar.me-1
                    | Staff Reports
                li.nav-item
                  a.nav-link(href='/users' class=req && req.path.includes('/users') ? 'active' : '')
                    i.fas.fa-users.me-1
                    | Users
                if user.role === 'manager'
                  li.nav-item
                    a.nav-link(href='/inventory' class=req && req.path.includes('/inventory') ? 'active' : '')
                      i.fas.fa-boxes.me-1
                      | Inventory
              else if user.role === 'customer'
                li.nav-item
                  a.nav-link(href='/customer/dashboard' class=req && req.path.includes('/customer') ? 'active' : '')
                    i.fas.fa-tachometer-alt.me-1
                    | My Dashboard
                li.nav-item
                  a.nav-link(href='/search' class=req && req.path.includes('/search') ? 'active' : '')
                    i.fas.fa-search.me-1
                    | Search Movies
            else
              li.nav-item
                a.nav-link(href='/users' class=req && req.path.includes('/users') ? 'active' : '')
                  i.fas.fa-users.me-1
                  | Users
          
          //- Search form (always show)
          form.d-flex.me-3(role='search' action='/search' method='GET')
            input.form-control.me-2(type='search' name='q' placeholder='Search movies...' aria-label='Search')
            button.btn.btn-outline-light(type='submit')
              i.fas.fa-search
          
          //- User authentication section
          ul.navbar-nav
            if authenticated && user
              li.nav-item.dropdown
                a.nav-link.dropdown-toggle(href='#' role='button' data-bs-toggle='dropdown' aria-expanded='false')
                  i.fas.fa-user.me-1
                  | #{user.name || user.username}
                  span.badge.bg-secondary.ms-1= user.role
                ul.dropdown-menu.dropdown-menu-end
                  li
                    h6.dropdown-header
                      i.fas.fa-info-circle.me-1
                      | Account Info
                  li
                    span.dropdown-item-text
                      small Role: #{user.role}
                  li
                    hr.dropdown-divider
                  li
                    form(action='/auth/logout' method='POST' style='display: inline;')
                      button.dropdown-item(type='submit')
                        i.fas.fa-sign-out-alt.me-1
                        | Logout
            else
              li.nav-item
                a.nav-link(href='/auth/login')
                  i.fas.fa-sign-in-alt.me-1
                  | Login

    //- Main content area
    main.container-fluid.py-4
      block content

    //- Footer
    footer.bg-dark.text-light.py-4.mt-5
      .container
        .row
          .col-md-6
            h5
              i.fas.fa-video.me-2
              | Sakila Video Store
            p.small System for managing video rentals and customer relationships.
          .col-md-6.text-md-end
            p.small
              | Â© 2024 Sakila Video Store. Demo application using Sakila sample database.
            if authenticated && user
              p.small
                i.fas.fa-user-check.me-1
                | Logged in as: #{user.name || user.username} (#{user.role})